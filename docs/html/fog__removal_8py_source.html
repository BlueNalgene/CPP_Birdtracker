<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>CPP_Birdtracker: fog_removal.py Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">CPP_Birdtracker
   </div>
   <div id="projectbrief">A C++ object tracking program specifically for lunar bird tracking</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
</div><!-- top -->
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">fog_removal.py</div>  </div>
</div><!--header-->
<div class="contents">
<a href="fog__removal_8py.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno"><a class="line" href="namespacefog__removal.html">    1</a></span>&#160;<span class="comment"># CPP_Birdtracker/fog_removal.py - Script to determine appropriate BLACKOUT_THRESH</span></div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="comment"># Copyright (C) &lt;2020&gt;  &lt;Wesley T. Honeycutt&gt;</span></div><div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="comment"># </span></div><div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="comment"># This program is free software: you can redistribute it and/or modify</span></div><div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="comment"># it under the terms of the GNU General Public License as published by</span></div><div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="comment"># the Free Software Foundation, either version 3 of the License, or</span></div><div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="comment"># (at your option) any later version.</span></div><div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="comment"># </span></div><div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="comment"># This program is distributed in the hope that it will be useful,</span></div><div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="comment"># but WITHOUT ANY WARRANTY; without even the implied warranty of</span></div><div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<span class="comment"># MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the</span></div><div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;<span class="comment"># GNU General Public License for more details.</span></div><div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;<span class="comment"># </span></div><div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;<span class="comment"># You should have received a copy of the GNU General Public License</span></div><div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;<span class="comment"># along with this program.  If not, see &lt;http://www.gnu.org/licenses/&gt;.</span></div><div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;</div><div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;</div><div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;</div><div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;</div><div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;<span class="comment"># Default imports</span></div><div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;<span class="keyword">import</span> os</div><div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;<span class="keyword">import</span> subprocess</div><div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;</div><div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;<span class="comment"># User imports</span></div><div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;<span class="keyword">import</span> numpy <span class="keyword">as</span> np</div><div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;<span class="keyword">import</span> cv2</div><div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;</div><div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;<span class="stringliteral">&quot;&quot;&quot;!</span></div><div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;<span class="stringliteral">This is a user configurable option to match the color schema of your terminal for using the ascii</span></div><div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;<span class="stringliteral">imaging options.  If your terminal is dark text on a light background, set to False.  If your</span></div><div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;<span class="stringliteral">terminal is light text on a dark background, set to True.  You can safely ignore this if you</span></div><div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;<span class="stringliteral">are using the GUI version.</span></div><div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;<span class="stringliteral">&quot;&quot;&quot;</span></div><div class="line"><a name="l00051"></a><span class="lineno"><a class="line" href="namespacefog__removal.html#ad88aa1ec890d366b2f2c71131bc1f657">   51</a></span>&#160;BLACK_BACK = <span class="keyword">True</span></div><div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;</div><div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;</div><div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;TOGGLE_PRESSED = <span class="keyword">False</span></div><div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;TOGGLE_ASC = <span class="keyword">False</span></div><div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;</div><div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;<span class="keyword">def </span>nothing(args):</div><div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;    <span class="stringliteral">&quot;&quot;&quot;</span></div><div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;<span class="stringliteral">    nothing</span></div><div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;<span class="stringliteral">    &quot;&quot;&quot;</span></div><div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;    <span class="keywordflow">pass</span></div><div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;</div><div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;</div><div class="line"><a name="l00064"></a><span class="lineno"><a class="line" href="namespacefog__removal.html#acc10907c635ab765dcf02a6fc6499620">   64</a></span>&#160;<span class="keyword">def </span><a class="code" href="namespacefog__removal.html#acc10907c635ab765dcf02a6fc6499620">create_directions</a>():</div><div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;    <span class="stringliteral">&quot;&quot;&quot;!</span></div><div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;<span class="stringliteral">    Create intro/directions slide for the thresholding Python script.</span></div><div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;<span class="stringliteral">    </span></div><div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;<span class="stringliteral">    @return image A 1080x1080 black 3 color image with red text (CV Mat)</span></div><div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;<span class="stringliteral">    &quot;&quot;&quot;</span></div><div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;    image = np.zeros((1000, 1000, 3))</div><div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;    font = cv2.FONT_HERSHEY_SIMPLEX</div><div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;    text_color = (0, 0, 255)</div><div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;    text_lines = [<span class="stringliteral">&quot;Use this program to determine the optimal threshold&quot;</span>, \</div><div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;                <span class="stringliteral">&quot;value for the input vid.  Adjust the \&quot;Threshold\&quot;&quot;</span>, \</div><div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;                <span class="stringliteral">&quot;slider until the fog around the moon disappears and the&quot;</span>, \</div><div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;                <span class="stringliteral">&quot;edge of the moon is crisp, without losing parts of the&quot;</span>, \</div><div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;                <span class="stringliteral">&quot;edge. When you are happy with the results, use the value&quot;</span>, \</div><div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;                <span class="stringliteral">&quot;on the slider in this windowas the value for &quot;</span>, \</div><div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;                <span class="stringliteral">&quot;BLACKOUT_THRESH in settings.cfg.&quot;</span>, \</div><div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;                <span class="stringliteral">&quot;&quot;</span>, <span class="stringliteral">&quot;&quot;</span>, <span class="stringliteral">&quot;&quot;</span>, <span class="stringliteral">&quot;&quot;</span>, <span class="stringliteral">&quot;&quot;</span>, <span class="stringliteral">&quot;&quot;</span>, \</div><div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;                <span class="stringliteral">&quot;To exit this script, press ESC&quot;</span>, \</div><div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;                <span class="stringliteral">&quot;&quot;</span>, <span class="stringliteral">&quot;&quot;</span>, <span class="stringliteral">&quot;&quot;</span>, \</div><div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;                <span class="stringliteral">&quot;To begin testing the image, or return to these directions,&quot;</span>, \</div><div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;                <span class="stringliteral">&quot;use the \&quot;Directions\&quot; slider&quot;</span></div><div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;    ]</div><div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;    <span class="keywordflow">for</span> i, j <span class="keywordflow">in</span> enumerate(text_lines):</div><div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;        image = cv2.putText(image, j, (50, 50*(i+1)), font, 1, text_color, 2, cv2.LINE_AA)</div><div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;    <span class="keywordflow">return</span> image</div><div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;</div><div class="line"><a name="l00090"></a><span class="lineno"><a class="line" href="namespacefog__removal.html#a6e25df53e59d9d8848b5e2ed5a399ea3">   90</a></span>&#160;<span class="keyword">def </span><a class="code" href="namespacefog__removal.html#a6e25df53e59d9d8848b5e2ed5a399ea3">ascii_version</a>(in_frame):</div><div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;    <span class="stringliteral">&quot;&quot;&quot;!</span></div><div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;<span class="stringliteral">    This is a terminal-only version of the fog removal code.  In this loop, the user is prompted</span></div><div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;<span class="stringliteral">    for a threshold value to test or to exit by entering &quot;q&quot;.  The in_frame param passes through to</span></div><div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;<span class="stringliteral">    the nested function.</span></div><div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;<span class="stringliteral">    </span></div><div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;<span class="stringliteral">    @param in_frame The input 3-channel OpenCV image</span></div><div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;<span class="stringliteral">    &quot;&quot;&quot;</span></div><div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;    print(<span class="stringliteral">&quot;=======================================================================&quot;</span>)</div><div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;    print(<span class="stringliteral">&quot;Use this program to determine the optimal threshold value for the input vid.  ASCII mode is enabled for use in terminals without GUI access.  Try to make any fog around the moon disappear to make the moon appear with a crisp edge. Don&#39;t overdo it and lose some of the edge though!  The original image uses threshold 0, the max value of 255 will make all but the brightest spots disappear.  When you are happy with the results, use the value you entered as the value for BLACKOUT_THRESH in settings.cfg.\n&quot;</span>)</div><div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;    print(<span class="stringliteral">&quot;=======================================================================&quot;</span>)</div><div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;    local_exit_toggle = <span class="keyword">True</span></div><div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;    in_frame = cv2.cvtColor(in_frame, cv2.COLOR_BGR2GRAY)</div><div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;    <span class="keywordflow">while</span> (local_exit_toggle):</div><div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;        print(<span class="stringliteral">&quot;Enter a value between (0-255) or \&quot;q\&quot; to exit&quot;</span>)</div><div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;        local_string = input(<span class="stringliteral">&quot;Entry:&quot;</span>)</div><div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;        <span class="keywordflow">if</span> (local_string == <span class="stringliteral">&#39;q&#39;</span>) <span class="keywordflow">or</span> (local_string == <span class="stringliteral">&#39;Q&#39;</span>):</div><div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;            local_exit_toggle = <span class="keyword">False</span></div><div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;        <span class="keywordflow">elif</span> local_string.isdigit():</div><div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;            <span class="keywordflow">if</span> int(local_string) &lt; 256:</div><div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;                <a class="code" href="namespacefog__removal.html#a50fdb2a1e3f55a7f77230a689a372876">ascii_proc</a>(in_frame, int(local_string))</div><div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;            <span class="keywordflow">else</span>:</div><div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;                print(<span class="stringliteral">&quot;You entered an invalid integer value, please choose between 0-255&quot;</span>)</div><div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;        <span class="keywordflow">else</span>:</div><div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;            print(<span class="stringliteral">&quot;Unrecognized characters in entry.  Try again&quot;</span>)</div><div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;    <span class="keywordflow">return</span></div><div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;</div><div class="line"><a name="l00117"></a><span class="lineno"><a class="line" href="namespacefog__removal.html#a50fdb2a1e3f55a7f77230a689a372876">  117</a></span>&#160;<span class="keyword">def </span><a class="code" href="namespacefog__removal.html#a50fdb2a1e3f55a7f77230a689a372876">ascii_proc</a>(in_frame, thresh):</div><div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;    <span class="stringliteral">&quot;&quot;&quot;!</span></div><div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;<span class="stringliteral">    This function does the heavy lifting for the ASCII version of this code.  The input image</span></div><div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;<span class="stringliteral">    is cropped to ignore as much black background as possible, then resized to fit the user&#39;s</span></div><div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;<span class="stringliteral">    terminal (using output from `tput`).  The image is thresholded, and the output from this</span></div><div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;<span class="stringliteral">    thresholding operaiton is converted to a string of ASCII characters.  There are 97 characters</span></div><div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;<span class="stringliteral">    in the grayscale list.  If the user has a black background, as determined by the global</span></div><div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;<span class="stringliteral">    variable BLACK_BACK, the order of ASCII characters are reversed.  After printing our &quot;image&quot;,</span></div><div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;<span class="stringliteral">    the user is informed if the image was resized and reminded of what value they entered.</span></div><div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;<span class="stringliteral">    </span></div><div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;<span class="stringliteral">    @param in_frame The input 1-channel OpenCV image</span></div><div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;<span class="stringliteral">    @param thresh An integer between 0-255 to represent the threshold of to test here</span></div><div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;<span class="stringliteral">    &quot;&quot;&quot;</span></div><div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;    <span class="keyword">import</span> imutils</div><div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;    </div><div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;    <span class="comment"># Stores if the image was resized</span></div><div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;    rezzed = <span class="keyword">False</span></div><div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;    </div><div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;    <span class="comment"># Empty output &quot;image&quot;</span></div><div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;    picstring = <span class="stringliteral">&quot;&quot;</span></div><div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;    </div><div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;    <span class="comment"># Fetch the width of the user&#39;s terminal as an int</span></div><div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;    local_width = int(subprocess.check_output([<span class="stringliteral">&quot;tput&quot;</span>, <span class="stringliteral">&quot;cols&quot;</span>]).decode(<span class="stringliteral">&quot;ascii&quot;</span>).strip(<span class="stringliteral">&#39;\n&#39;</span>))</div><div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;    </div><div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;    <span class="comment"># A list of characters in order of descending darkness for use in ASCII images.  97 items.</span></div><div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;    ascii_list = [<span class="stringliteral">&quot;@&quot;</span>, <span class="stringliteral">&quot;M&quot;</span>, <span class="stringliteral">&quot;B&quot;</span>, <span class="stringliteral">&quot;H&quot;</span>, <span class="stringliteral">&quot;E&quot;</span>, <span class="stringliteral">&quot;N&quot;</span>, <span class="stringliteral">&quot;R&quot;, &quot;</span>#&quot;, &quot;K&quot;, &quot;W&quot;, &quot;X&quot;, &quot;D&quot;, &quot;F&quot;, &quot;P&quot;, &quot;Q&quot;, &quot;A&quot;, &quot;S&quot;, &quot;<span class="stringliteral">U&quot;, &quot;</span>Z&quot;, &quot;b&quot;, &quot;d&quot;, &quot;e&quot;, &quot;h&quot;, &quot;x&quot;, &quot;*&quot;, &quot;8&quot;, &quot;G&quot;, &quot;m&quot;, &quot;&amp;&quot;, &quot;0&quot;, &quot;4&quot;, &quot;L&quot;, &quot;O&quot;, &quot;V&quot;, &quot;Y&quot;, &quot;k&quot;, &quot;p&quot;, &quot;q&quot;, &quot;5&quot;, &quot;T&quot;, &quot;a&quot;, &quot;g&quot;, &quot;n&quot;, &quot;s&quot;, &quot;6&quot;, &quot;9&quot;, &quot;o&quot;, &quot;w&quot;, &quot;z&quot;, &quot;$&quot;, &quot;C&quot;, &quot;I&quot;, &quot;<span class="stringliteral">u&quot;, &quot;</span>2&quot;, &quot;3&quot;, &quot;J&quot;, &quot;c&quot;, &quot;f&quot;, &quot;<span class="stringliteral">r&quot;, &quot;</span>y&quot;, &quot;%&quot;, &quot;1&quot;, &quot;v&quot;, &quot;7&quot;, &quot;l&quot;, &quot;+&quot;, &quot;i&quot;, &quot;t&quot;, &quot;[&quot;, &quot;]&quot;, &quot;&quot;, &quot;{&quot;, &quot;}&quot;, &quot;?&quot;, &quot;j&quot;, &quot;|&quot;, &quot;(&quot;, &quot;)&quot;, &quot;=&quot;, &quot;~&quot;, &quot;!&quot;, &quot;-&quot;, &quot;/&quot;, &quot;&lt;&quot;, &quot;&gt;&quot;, &quot;\\&quot;, &quot;\&quot;&quot;, &quot;^&quot;, &quot;_&quot;, &quot;&#39;&quot;, &quot;;&quot;, &quot;,&quot;, &quot;:&quot;, &quot;`&quot;, &quot;.&quot;, &quot; &quot;, &quot; &quot;]</div><div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;    </div><div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;    <span class="comment"># For dark background terminals, use the reverse of the list</span></div><div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;    <span class="keywordflow">if</span> BLACK_BACK:</div><div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;        ascii_list.reverse()</div><div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;    </div><div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;    <span class="comment"># Divisor ratio to give weight to each ASCII value</span></div><div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;    ascii_ratio = 256/len(ascii_list)</div><div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;    </div><div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;    <span class="comment"># Fetch largest contour and crop to that size</span></div><div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;    contours, hierarchy = cv2.findContours(in_frame, cv2.RETR_EXTERNAL, cv2.CHAIN_APPROX_NONE)</div><div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;    <span class="comment"># Holds largest bounding box</span></div><div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;    box = (0,0,0,0)      <span class="comment"># biggest bounding box so far</span></div><div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;    <span class="comment"># Holds largest bounding box area</span></div><div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;    box_area = 0</div><div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;    <span class="keywordflow">for</span> cont <span class="keywordflow">in</span> contours:</div><div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;        <span class="comment"># Retrieves the boudning box properties x, y, width, and height</span></div><div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;        xxx, yyy, www, hhh = cv2.boundingRect(cont)</div><div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;        area = www * hhh</div><div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;        <span class="comment"># Check if this is a bigger one</span></div><div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;        <span class="keywordflow">if</span> area &gt; box_area:</div><div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;            box = xxx, yyy, www, hhh</div><div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;            box_area = area</div><div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;    <span class="comment"># Once we found the biggest contour, we re-grab the boundaries</span></div><div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;    xxx, yyy, www, hhh = box</div><div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;    <span class="comment"># And do an OpenCV crop</span></div><div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;    roi=in_frame[yyy:yyy+hhh, xxx:xxx+www]</div><div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;    </div><div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;    <span class="comment"># Resize the cropped image if the terminal is too small.</span></div><div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;    <span class="comment"># We only worry about width since modern terminals have scrolling height.</span></div><div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;    <span class="keywordflow">if</span> (roi.shape[0] &gt; local_width):</div><div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;        roi = imutils.resize(roi, width=local_width)</div><div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;        rezzed = <span class="keyword">True</span></div><div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;        oldcols = roi.shape[0]</div><div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;    </div><div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;    <span class="comment"># perform thresh</span></div><div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;    _, roi = cv2.threshold(roi, thresh, 255, cv2.THRESH_TOZERO)</div><div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;    </div><div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;    rows, cols = roi.shape</div><div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;    print(<span class="stringliteral">&quot;generating image...&quot;</span>)</div><div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;    <span class="keywordflow">for</span> i <span class="keywordflow">in</span> range(0, rows):</div><div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;        <span class="keywordflow">for</span> j <span class="keywordflow">in</span> range(0, cols):</div><div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;            <span class="comment"># Convert pixel value to scaled ASCII code.</span></div><div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;            picstring += ascii_list[int(roi[i, j]/ascii_ratio)]</div><div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;        picstring += <span class="stringliteral">&#39;\n&#39;</span></div><div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;    print(picstring)</div><div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;    <span class="keywordflow">if</span> rezzed:</div><div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;        print(<span class="stringliteral">&quot;Your terminal is&quot;</span>, local_width, <span class="stringliteral">&quot; pixels wide, but the cropped raw image was&quot;</span>, oldcols, <span class="stringliteral">&quot;pixels wide.  Your output has been resized.&quot;</span>)</div><div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;    print(<span class="stringliteral">&quot;The above image threshold value was&quot;</span>, thresh)</div><div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;    <span class="keywordflow">return</span></div><div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;</div><div class="line"><a name="l00193"></a><span class="lineno"><a class="line" href="namespacefog__removal.html#a7b07384f6a6ff8498e14f3aa5f8e2252">  193</a></span>&#160;<span class="keyword">def </span><a class="code" href="namespacefog__removal.html#a7b07384f6a6ff8498e14f3aa5f8e2252">is_valid_file</a>(parser, arg):</div><div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;    <span class="stringliteral">&quot;&quot;&quot;!</span></div><div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;<span class="stringliteral">    Check if arg is a valid file that already exists on the file system.</span></div><div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;<span class="stringliteral">    </span></div><div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;<span class="stringliteral">    @param parser the argparse object</span></div><div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;<span class="stringliteral">    @param arg the string of the filename we want to test</span></div><div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;<span class="stringliteral">    </span></div><div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;<span class="stringliteral">    @return arg</span></div><div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;<span class="stringliteral">    &quot;&quot;&quot;</span></div><div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;    arg = os.path.abspath(arg)</div><div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;    <span class="keywordflow">if</span> <span class="keywordflow">not</span> os.path.exists(arg):</div><div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;        parser.error(<span class="stringliteral">&quot;The file %s does not exist!&quot;</span> % arg)</div><div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;        <span class="keywordflow">raise</span> FileNotFoundError(<span class="stringliteral">&quot;The file you told the script to run on does not exist&quot;</span>)</div><div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;    <span class="keywordflow">else</span>:</div><div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;        <span class="keywordflow">return</span> arg</div><div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;</div><div class="line"><a name="l00209"></a><span class="lineno"><a class="line" href="namespacefog__removal.html#a7ea01fc3bbbb26aa0f4d20724849308c">  209</a></span>&#160;<span class="keyword">def </span><a class="code" href="namespacefog__removal.html#a7ea01fc3bbbb26aa0f4d20724849308c">check_positive</a>(value):</div><div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;    <span class="stringliteral">&quot;&quot;&quot;!</span></div><div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;<span class="stringliteral">    Check that the input integer for the starting frame number is valid</span></div><div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;<span class="stringliteral">    &quot;&quot;&quot;</span></div><div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;    ivalue = int(value)</div><div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;    <span class="keywordflow">if</span> ivalue &lt;= 0:</div><div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;        <span class="keywordflow">raise</span> RuntimeError(<span class="stringliteral">&quot;%s is an invalid positive int value&quot;</span> % value)</div><div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;    <span class="keywordflow">return</span> ivalue</div><div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;</div><div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;</div><div class="line"><a name="l00219"></a><span class="lineno"><a class="line" href="namespacefog__removal.html#a89c98f8f9a6d048485938fc05675ce9e">  219</a></span>&#160;<span class="keyword">def </span><a class="code" href="namespacefog__removal.html#a89c98f8f9a6d048485938fc05675ce9e">get_parser</a>():</div><div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;    <span class="stringliteral">&quot;&quot;&quot;!</span></div><div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;<span class="stringliteral">    Get parser object for this script</span></div><div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;<span class="stringliteral">    </span></div><div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;<span class="stringliteral">    @return Parser object</span></div><div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;<span class="stringliteral">    &quot;&quot;&quot;</span></div><div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;    <span class="keyword">from</span> argparse <span class="keyword">import</span> ArgumentParser, ArgumentDefaultsHelpFormatter</div><div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;    parser = ArgumentParser(description=__doc__, formatter_class=ArgumentDefaultsHelpFormatter)</div><div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;    parser.add_argument(<span class="stringliteral">&quot;-f&quot;</span>, <span class="stringliteral">&quot;--file&quot;</span>, dest=<span class="stringliteral">&quot;filename&quot;</span>, required=<span class="keyword">True</span>,\</div><div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;        type=<span class="keyword">lambda</span> x: <a class="code" href="namespacefog__removal.html#a7b07384f6a6ff8498e14f3aa5f8e2252">is_valid_file</a>(parser, x), help=<span class="stringliteral">&quot;video input FILE&quot;</span>, metavar=<span class="stringliteral">&quot;FILE&quot;</span>)</div><div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;    parser.add_argument(<span class="stringliteral">&quot;-n&quot;</span>, <span class="stringliteral">&quot;--nth_frame&quot;</span>, dest=<span class="stringliteral">&quot;max_frame&quot;</span>, required=<span class="keyword">False</span>,\</div><div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;        type=check_positive, help=<span class="stringliteral">&quot;Use the nth frame of the video to test fog&quot;</span>, \</div><div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;        nargs=<span class="keywordtype">None</span>, default=100, metavar=<span class="stringliteral">&#39;N&#39;</span>)</div><div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;    parser.add_argument(<span class="stringliteral">&quot;-a&quot;</span>, <span class="stringliteral">&quot;--ascii&quot;</span>, dest=<span class="stringliteral">&quot;ascii_toggle&quot;</span>, required=<span class="keyword">False</span>, action=<span class="stringliteral">&quot;store_true&quot;</span>,\</div><div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;        help=<span class="stringliteral">&quot;Toggle for an ascii (terminal) only version of this script&quot;</span>, default=<span class="keyword">False</span>)</div><div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;    <span class="keywordflow">return</span> parser</div><div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;</div><div class="line"><a name="l00236"></a><span class="lineno"><a class="line" href="namespacefog__removal.html#a427a577da8405e5624962d7ef722aadf">  236</a></span>&#160;<span class="keyword">def </span><a class="code" href="namespacefog__removal.html#a427a577da8405e5624962d7ef722aadf">main</a>():</div><div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;    <span class="stringliteral">&quot;&quot;&quot;!</span></div><div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;<span class="stringliteral">    Perform primary functions of this script.</span></div><div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;<span class="stringliteral">    Command line arguments are first parsed to get the file name on which we want to operate.  Then,</span></div><div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;<span class="stringliteral">    we ensure that this is a valid file.  The video file is opened and the first frame is read.</span></div><div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;<span class="stringliteral">    We then create our output window of size 1080x1080 and trackbars for the Directions toggle and</span></div><div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;<span class="stringliteral">    Image Threshold.  If everything was successful, the window opens with the Diretions image.  When</span></div><div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;<span class="stringliteral">    the user tells the Directions to toggle closed, the first frame from the video is shown after</span></div><div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;<span class="stringliteral">    conversion to grayscale and thresholded to zero.  The image threshold is determined by the value</span></div><div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;<span class="stringliteral">    of the threshold trackbar.  The user exits with the ESC key.  On exit, the final value of the</span></div><div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;<span class="stringliteral">    threshold is printed to the terminal.</span></div><div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;<span class="stringliteral">    &quot;&quot;&quot;</span></div><div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;    <span class="comment"># Prepare input file based on the terminal command args</span></div><div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;    args = <a class="code" href="namespacefog__removal.html#a89c98f8f9a6d048485938fc05675ce9e">get_parser</a>().parse_args()</div><div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;    print(<span class="stringliteral">&quot;Operating on file:&quot;</span>, args.filename)</div><div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;    <span class="comment"># Get the first frame of the video from the terminal command</span></div><div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;    cap = cv2.VideoCapture(args.filename)</div><div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;    ret, frame = cap.read()</div><div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;    cnt = 1</div><div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;    cnt_max = args.max_frame</div><div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;    TOGGLE_ASC = args.ascii_toggle</div><div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;    <span class="keywordflow">while</span> cnt &lt; cnt_max:</div><div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;        ret, frame = cap.read()</div><div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;        cnt = cnt + 1</div><div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;    <span class="keywordflow">if</span> TOGGLE_ASC:</div><div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;        <a class="code" href="namespacefog__removal.html#a6e25df53e59d9d8848b5e2ed5a399ea3">ascii_version</a>(frame)</div><div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;    <span class="keywordflow">else</span>:</div><div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;        <span class="comment"># Create our window and relevant trackbars  </span></div><div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;        cv2.namedWindow(<span class="stringliteral">&quot;image&quot;</span>, cv2.WINDOW_NORMAL)</div><div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;        cv2.resizeWindow(<span class="stringliteral">&quot;image&quot;</span>, 1080, 1080)</div><div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;        cv2.createTrackbar(<span class="stringliteral">&quot;Directions&quot;</span>, <span class="stringliteral">&quot;image&quot;</span>, 0, 1, nothing)</div><div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;        cv2.createTrackbar(<span class="stringliteral">&quot;Threshold&quot;</span>, <span class="stringliteral">&quot;image&quot;</span>, 0, 255, nothing)</div><div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;        <span class="comment"># Misc initial values</span></div><div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;        outimg = <a class="code" href="namespacefog__removal.html#acc10907c635ab765dcf02a6fc6499620">create_directions</a>()</div><div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;        <span class="comment"># If we got a video frame, execute the main loop.</span></div><div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;        <span class="keywordflow">if</span> ret:</div><div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;            <span class="comment"># Misc initial values</span></div><div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;            pretest = 0</div><div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;            thresh = 0</div><div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;            <span class="comment"># Convert input image to gray</span></div><div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;            frame = cv2.cvtColor(frame, cv2.COLOR_BGR2GRAY)</div><div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;            while(1):</div><div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;                <span class="comment"># Get the value of your directions toggle</span></div><div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;                local_button = cv2.getTrackbarPos(<span class="stringliteral">&quot;Directions&quot;</span>, <span class="stringliteral">&quot;image&quot;</span>)</div><div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;                <span class="keywordflow">if</span> (local_button == 0) <span class="keywordflow">and</span> (pretest == 1):</div><div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;                    outimg = <a class="code" href="namespacefog__removal.html#acc10907c635ab765dcf02a6fc6499620">create_directions</a>()</div><div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;                <span class="comment"># Set the value for the directions toggle</span></div><div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;                <span class="keywordflow">if</span> local_button &gt; 0:</div><div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;                    TOGGLE_PRESSED = <span class="keyword">True</span></div><div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;                <span class="keywordflow">else</span>:</div><div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;                    TOGGLE_PRESSED = <span class="keyword">False</span></div><div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;                <span class="comment"># Process the image with the threshold value</span></div><div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;                <span class="keywordflow">if</span> (TOGGLE_PRESSED):</div><div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;                    thresh = cv2.getTrackbarPos(<span class="stringliteral">&quot;Threshold&quot;</span>, <span class="stringliteral">&quot;image&quot;</span>)</div><div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;                    _, outimg = cv2.threshold(frame, thresh, 255, cv2.THRESH_TOZERO)</div><div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;                <span class="comment"># Show the image, either directions or the thresholded image</span></div><div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;                cv2.imshow(<span class="stringliteral">&quot;image&quot;</span>, outimg)</div><div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;                <span class="comment"># ESC to kill this script</span></div><div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;                kill = cv2.waitKey(1) &amp; 0xFF</div><div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;                <span class="keywordflow">if</span> kill == 27:</div><div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;                    print(<span class="stringliteral">&quot;Your final threshold value was:&quot;</span>, thresh)</div><div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;                    <span class="keywordflow">break</span></div><div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;                <span class="comment"># Set the pretest value for the next loop</span></div><div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;                pretest = local_button</div><div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;        </div><div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;        <span class="keywordflow">else</span>:</div><div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;            <span class="comment"># Error loading video</span></div><div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;            <span class="keywordflow">raise</span> RuntimeError(<span class="stringliteral">&quot;ERROR: could not get frame from video&quot;</span>)</div><div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;        cv2.destroyAllWindows()</div><div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;    <span class="keywordflow">return</span></div><div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;</div><div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;<span class="keywordflow">if</span> __name__ == <span class="stringliteral">&quot;__main__&quot;</span>:</div><div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;    <a class="code" href="namespacefog__removal.html#a427a577da8405e5624962d7ef722aadf">main</a>()</div><div class="ttc" id="namespacefog__removal_html_a7ea01fc3bbbb26aa0f4d20724849308c"><div class="ttname"><a href="namespacefog__removal.html#a7ea01fc3bbbb26aa0f4d20724849308c">fog_removal.check_positive</a></div><div class="ttdeci">def check_positive(value)</div><div class="ttdoc">Check that the input integer for the starting frame number is valid. </div><div class="ttdef"><b>Definition:</b> <a href="fog__removal_8py_source.html#l00209">fog_removal.py:209</a></div></div>
<div class="ttc" id="namespacefog__removal_html_a50fdb2a1e3f55a7f77230a689a372876"><div class="ttname"><a href="namespacefog__removal.html#a50fdb2a1e3f55a7f77230a689a372876">fog_removal.ascii_proc</a></div><div class="ttdeci">def ascii_proc(in_frame, thresh)</div><div class="ttdoc">This function does the heavy lifting for the ASCII version of this code. </div><div class="ttdef"><b>Definition:</b> <a href="fog__removal_8py_source.html#l00117">fog_removal.py:117</a></div></div>
<div class="ttc" id="namespacefog__removal_html_a6e25df53e59d9d8848b5e2ed5a399ea3"><div class="ttname"><a href="namespacefog__removal.html#a6e25df53e59d9d8848b5e2ed5a399ea3">fog_removal.ascii_version</a></div><div class="ttdeci">def ascii_version(in_frame)</div><div class="ttdoc">This is a terminal-only version of the fog removal code. </div><div class="ttdef"><b>Definition:</b> <a href="fog__removal_8py_source.html#l00090">fog_removal.py:90</a></div></div>
<div class="ttc" id="namespacefog__removal_html_a427a577da8405e5624962d7ef722aadf"><div class="ttname"><a href="namespacefog__removal.html#a427a577da8405e5624962d7ef722aadf">fog_removal.main</a></div><div class="ttdeci">def main()</div><div class="ttdoc">Perform primary functions of this script. </div><div class="ttdef"><b>Definition:</b> <a href="fog__removal_8py_source.html#l00236">fog_removal.py:236</a></div></div>
<div class="ttc" id="namespacefog__removal_html_a89c98f8f9a6d048485938fc05675ce9e"><div class="ttname"><a href="namespacefog__removal.html#a89c98f8f9a6d048485938fc05675ce9e">fog_removal.get_parser</a></div><div class="ttdeci">def get_parser()</div><div class="ttdoc">Get parser object for this script. </div><div class="ttdef"><b>Definition:</b> <a href="fog__removal_8py_source.html#l00219">fog_removal.py:219</a></div></div>
<div class="ttc" id="namespacefog__removal_html_a7b07384f6a6ff8498e14f3aa5f8e2252"><div class="ttname"><a href="namespacefog__removal.html#a7b07384f6a6ff8498e14f3aa5f8e2252">fog_removal.is_valid_file</a></div><div class="ttdeci">def is_valid_file(parser, arg)</div><div class="ttdoc">Check if arg is a valid file that already exists on the file system. </div><div class="ttdef"><b>Definition:</b> <a href="fog__removal_8py_source.html#l00193">fog_removal.py:193</a></div></div>
<div class="ttc" id="namespacefog__removal_html_acc10907c635ab765dcf02a6fc6499620"><div class="ttname"><a href="namespacefog__removal.html#acc10907c635ab765dcf02a6fc6499620">fog_removal.create_directions</a></div><div class="ttdeci">def create_directions()</div><div class="ttdoc">Create intro/directions slide for the thresholding Python script. </div><div class="ttdef"><b>Definition:</b> <a href="fog__removal_8py_source.html#l00064">fog_removal.py:64</a></div></div>
</div><!-- fragment --></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.13
</small></address>
</body>
</html>
